var HttpClient,firstScriptTag,onPlayerReady,onPlayerStateChange,onYouTubeIframeAPIReady,plr,randSong,songDataReady,song_data,stopVideo,tag,url_params;song_data=null,plr=null,url_params=["enablejsapi=1","controls=0","autoplay=1","cc_load_policy=0","disablekb=1","iv_load_policy=3","autohide=1","origin=http://localhost:8002","playsinline=1","fs=0","rel=0"].join("&"),tag=document.createElement("script"),tag.src="https://www.youtube.com/iframe_api",firstScriptTag=document.getElementsByTagName("script")[0],firstScriptTag.parentNode.insertBefore(tag,firstScriptTag),onYouTubeIframeAPIReady=function(){var t,a;a=new YT.Player("player",{events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}}),plr=a,null===song_data?(console.log("data null"),t=new HttpClient,t.get("http://jombly.com:3000/today",function(t){var a;return song_data=JSON.parse(t),a=song_data.length-1,songDataReady()})):(console.log("data exists"),songDataReday())},songDataReady=function(){return console.log(song_data),player.src="http://www.youtube.com/embed/"+randSong().youtubeId+"?"+url_params},onPlayerReady=function(){},onPlayerStateChange=function(t){var a,e,n;e=t.target,t.data===YT.PlayerState.PLAYING&&(a=e.getDuration(),$("#progress").attr("max",a),n=setInterval(function(){var t,n;return t=e.getCurrentTime(),n=t/a*100,$("#progress").val(t)},1e3)),t.data===YT.PlayerState.ENDED&&(clearTimeout(n),e.src="http://www.youtube.com/embed/"+randSong().youtubeId+"?"+url_params,e.playVideo()),t.data===YT.PlayerState.PAUSED&&clearTimeout(n)},stopVideo=function(){player.stopVideo()},randSong=function(){return song_data[Math.floor(Math.random()*song_data.length)]},HttpClient=function(){this.get=function(t,a){var e;e=new XMLHttpRequest,e.onreadystatechange=function(){4===e.readyState&&200===e.status&&a(e.responseText)},e.open("GET",t,!0),e.send(null)}},$("#next").on("click",function(){var t;return t=randSong(),console.log(t.query),player.src="http://www.youtube.com/embed/"+t.youtubeId+"?"+url_params}),$("#progress").on("input",function(){return plr.seekTo(this.value)}),$("#progress").on("change",function(){return plr.seekTo(this.value)});
