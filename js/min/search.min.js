var HttpClient,current_song,initData,newSong,onPlayerReady,onPlayerStateChange,onYouTubeIframeAPIReady,pauseVideo,player,randSong,resize,songDataReady,song_data,startVideo,stopVideo,url_params;song_data=null,current_song=null,player=null,url_params=["enablejsapi=1","origin=http://localhost:8002","controls=0","showinfo=0","modestbranding=0","autoplay=1","cc_load_policy=0","disablekb=1","iv_load_policy=3","origin=http://localhost:8002","playsinline=1","fs=0","rel=0","wmode=transparent"].join("&"),initData=function(){var t;return t=new HttpClient,t.get("http://jombly.com:3000/today",function(t){return song_data=JSON.parse(t),songDataReady()})},onYouTubeIframeAPIReady=function(){var t,e,n;n=$(window).width(),t=16/9,e=randSong(),current_song=e,player=new YT.Player("player",{width:$(window).width(),height:Math.ceil(n/t),videoId:e.youtubeId,playerVars:{controls:0,showinfo:0,modestbranding:1,autoplay:1,cc_load_policy:0,disablekb:1,iv_load_policy:3,origin:"http://localhost:8002",playsinline:1,fs:0,rel:0,wmode:"transparent"},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}})},resize=function(){var t,e,n,a,o,r;return r=$(window).width(),t=$(window).height(),a=$("#player"),o=16/9,t>r/o?(n=Math.ceil(t*o),a.width(n).height(t).css({left:(r-n)/2,top:0})):(e=Math.ceil(r/o),a.width(r).height(e).css({left:0,top:(t-e)/2}))},songDataReady=function(){var t,e,n;for(e=0,n=song_data.length;n>e;e++)t=song_data[e],$("#topList ol").append("<li class='topSong' data-song="+t.rank+"> <strong>"+t.artist+"</strong> / <em>"+t.title+"</em> </li>")},onPlayerReady=function(){$("#songInfo").text(""+current_song.artist+" - "+current_song.title)},onPlayerStateChange=function(t){var e,n;player=t.target,t.data===YT.PlayerState.PLAYING&&(e=player.getDuration(),$("#progress").attr("max",e),n=setInterval(function(){var t,n;return t=player.getCurrentTime(),n=t/e*100,$("#progress").val(t)},1e3)),t.data===YT.PlayerState.ENDED&&(clearTimeout(n),newSong()),t.data===YT.PlayerState.PAUSED&&clearTimeout(n)},stopVideo=function(){player.stopVideo()},startVideo=function(){player.playVideo()},pauseVideo=function(){player.pauseVideo()},newSong=function(t){return null==t&&(t=randSong()),player.loadVideoById(t.youtubeId),current_song=t,$("#songInfo").text(""+current_song.artist+" - "+current_song.title)},randSong=function(){return song_data[Math.floor(Math.random()*song_data.length)]},HttpClient=function(){this.get=function(t,e){var n;n=new XMLHttpRequest,n.onreadystatechange=function(){4===n.readyState&&200===n.status&&e(n.responseText)},n.open("GET",t,!0),n.send(null)}},$("#next").on("click",function(){return newSong()}),$("#topListBtn").on("click",function(){return $("#screen").toggleClass("active"),$("#topListBtn").toggleClass("active"),$("#topList").toggleClass("active"),$("#info").removeClass("active"),$("#songInfo").removeClass("active")}),$("#topList").on("click",".topSong",function(){var t;return t=this.getAttribute("data-song"),newSong(song_data[t-1]),$("#screen").toggleClass("active"),$("#topListBtn").toggleClass("active"),$("#topList").toggleClass("active")}),$("#progress").on("input",function(){return player.seekTo(this.value)}),$("#play").on("click",function(){return $("#play").toggleClass("hidden"),$("#pause").toggleClass("hidden"),startVideo()}),$("#pause").on("click",function(){return $("#play").toggleClass("hidden"),$("#pause").toggleClass("hidden"),pauseVideo()}),$("#info").on("click",function(){return $("#topListBtn").removeClass("active"),$("#topList").removeClass("active"),$("#screen").removeClass("active"),$("#info").toggleClass("active"),$("#songInfo").toggleClass("active")}),$("#progress").on("change",function(){return player.seekTo(this.value)}),$(window).on("resize",function(){return resize()}),$(document).ready(function(){return initData(),resize()});
